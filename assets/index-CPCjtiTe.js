import{_ as B,H as I,r as b,a as k,w as z,e as L,q as A,z as V,j as w,I as F,u as h,p as j,c as K,J as D,E as v,G as $,t as T,K as U,v as O}from"./index-CeXHvuUL.js";import{E as H,T as E}from"./index-i0bbB2dU.js";import{U as f}from"./index-g1FXTl7-.js";const _="#FF5B5B",Y="#ff3737",S="#91F840",P="#6fda1a",R={__name:"RealTimeChart",props:{candles:{type:Object,default:{}}},emits:["reOrder"],setup(M,{emit:c}){const p=M,m=c,a=I(),u=b(null),o=b(null);let l=k({});z(()=>p.candles,()=>{l=p.candles,x()},{deep:!0}),L(()=>{l=p.candles,l.data.width=u.value.getWidth()});const x=()=>{o.value={backgroundColor:"#131313",title:{text:"即時走勢",left:10,top:10,bottom:10,textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(0,0,0,0.3)",textStyle:{color:"#FFF"},formatter:function(t){let e=t.filter(C=>C.seriesIndex==0)[0],s=t.filter(C=>C.seriesIndex==1)[0],r=t.filter(C=>C.seriesIndex==2)[0],d,i,y;return e?(d=l.data.list[e.dataIndex-1]?l.data.list[e.dataIndex-1][1]:a.info.data.previousClose,i=(e.value[2]-d).toFixed(2),y=(i/d*100).toFixed(2),`<div style=" text-align: left;">
                        ${t[0].name} <br/>
                        <span style="color:${n(e.value[1],d)}">開 :<span style="margin-left: 10px">${e.value[1]}</span></span><br/>
                        <span style="color:${n(e.value[2],d)}">收 :<span style="margin-left: 10px">${e.value[2]}</span></span><br/>
                        <span style="color:${n(e.value[3],d)}">低 :<span style="margin-left: 10px">${e.value[3]}</span></span><br/>
                        <span style="color:${n(e.value[4],d)}">高 :<span style="margin-left: 10px">${e.value[4]}</span></span><br/> 
                        <span style="color:${n(i)}">${i>0?"漲":"跌"} :<span style="margin-left: 10px">${i>0?"+"+i:i}</span></span><br/>
                        <span style="color:${n(i)}">幅 :<span style="margin-left: 10px">${i>0?"+"+y:y}%</span></span><br/>
                        量 :<span style="margin-left: 10px">${(s.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`):(d=a.info.data.previousClose,i=(r.value[1]-d).toFixed(2),y=(i/d*100).toFixed(2),`<div style=" text-align: left;">
                        ${t[0].name} <br/>
                        <span style="color:${n(r.value[1],a.info.data.previousClose)}">價 :<span style="margin-left: 10px">${r.value[1]}</span></span><br/>
                        <span style="color:${n(i)}">${i>0?"漲":"跌"} :<span style="margin-left: 10px">${i>0?"+"+i:i}</span></span><br/>
                        <span style="color:${n(i)}">幅 :<span style="margin-left: 10px">${i>0?"+"+y:y}%</span></span><br/>
                        量 :<span style="margin-left: 10px">${(s.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`)},position:function(t,e,s,r,d){const i={top:10};return i[["left","right"][+(t[0]<d.viewSize[0]/2)]]=30,i}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},toolbox:{show:!0,top:10,right:10,feature:{mytooo:{show:!0,title:"Custom Button",icon:"path://m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z",onclick:function(){u.value.resize({width:l.data.isBig?l.data.width:l.data.width*2}),l.data.isBig=!l.data.isBig,m("reOrder",l.data.isBig,0)}}}},dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"85%",start:0,end:100}],visualMap:[{show:!1,seriesIndex:1,dimension:2,pieces:[{value:-1,color:S},{value:1,color:_}]},{show:!1,seriesIndex:2,dimension:1,pieces:[{lte:a.info.data.previousClose-1,color:P},{gt:a.info.data.previousClose,color:Y}]}],legend:{selected:{走勢:l.data.currentSel=="走勢",一分K:l.data.currentSel=="一分K"},top:10,selectedMode:"single",data:["走勢","一分K"]},series:[{name:"一分K",type:"candlestick",data:l.data.list,itemStyle:{color:_,color0:S,borderColor:Y,borderColor0:P},tooltip:{formatter:function(t){return t.name+"<br>"+(t.data.coord||"")}},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,data:l.data.volume},{name:"走勢",type:"line",showSymbol:!1,data:l.data.trend,markLine:{label:{show:!1},symbol:["none","none"],data:[{yAxis:a.info.data.previousClose,name:"固定值 100"}],lineStyle:{color:"#FFF"}},markPoint:{data:[{type:"max",name:"Max",label:{position:"top",distance:-10}},{type:"min",name:"Min",label:{position:"bottom",distance:-10}}],symbol:"image://",label:{show:!0,formatter:function(t){return t.value>a.info.data.previousClose?`{a|${t.value}}`:`{b|${t.value}}`},rich:{a:{color:_},b:{color:S}}}}}],grid:[{left:"10%",right:"8%",height:"50%"},{left:"10%",right:"8%",top:"63%",height:"16%"}],xAxis:[{type:"category",data:l.data.category,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"},{type:"category",gridIndex:1,data:l.data.category,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0,splitArea:{show:!0},splitLine:{lineStyle:{type:"dashed",color:"#3C3C3C",width:1}},min:t=>l.data.currentSel=="一分K"?t.min:l.data.low>a.info.data.previousClose?(a.info.data.previousClose*.99).toFixed(0):(t.min*.99).toFixed(0),max:t=>l.data.currentSel=="一分K"?t.max:l.data.high>a.info.data.previousClose?(t.max*1.01).toFixed(0):(a.info.data.previousClose*1.01).toFixed(0)},{scale:!0,gridIndex:1,splitNumber:2,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}]}},g=t=>{l.data.currentSel=t.name,u.value.resize()},n=(t,e=0)=>{if(t!=e)return t>e?_:S};return(t,e)=>{var s,r;return A(),V("div",null,[w(h(H),{ref_key:"chart",ref:u,class:F({chart:!((s=h(l).data)!=null&&s.isBig),chartBig:(r=h(l).data)==null?void 0:r.isBig}),option:o.value,onLegendselectchanged:g,autoresize:""},null,8,["class","option"])])}}},G=B(R,[["__scopeId","data-v-58b4920a"]]),Z="#FF5B5B",W="#ff3737",N="#91F840",X="#6fda1a",q={__name:"HistoryChart",props:{candles:{type:Object,default:{}}},emits:["reOrder","chgLegend"],setup(M,{emit:c}){const p=M,m=c;I();const a=b(null),u=b(null);let o=k({});z(()=>p.candles,()=>{o=p.candles,l()},{deep:!0}),L(()=>{o=p.candles,o.data.width=a.value.getWidth()});const l=()=>{u.value={backgroundColor:"#131313",title:{text:"股價走勢",left:10,top:10,bottom:10,textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(0,0,0,0.3)",textStyle:{color:"#FFF"},formatter:function(n){return`<div style="text-align: left;">${n[0].value[0]}<div>
                        <div> 股價:<span style="padding-left: 10px">${n[0].value[1]}</span><div>`},position:function(n,t,e,s,r){const d={top:10};return d[["left","right"][+(n[0]<r.viewSize[0]/2)]]=30,d}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},toolbox:{show:!0,top:10,right:10,feature:{mytooo:{show:!0,title:"Custom Button",icon:"path://m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z",onclick:function(){a.value.resize({width:o.data.isBig?o.data.width:o.data.width*2}),o.data.isBig=!o.data.isBig,m("reOrder",o.data.isBig,1)}}}},dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"85%",start:0,end:100}],visualMap:[{show:!1,seriesIndex:[0,1,2],dimension:1,pieces:[{lte:o.data.lastClose-1,color:X},{gt:o.data.lastClose,color:W}]}],legend:{selected:{"1M":o.data.currentSel=="1M","6M":o.data.currentSel=="6M","1Y":o.data.currentSel=="1Y"},top:10,selectedMode:"single",data:["1M","6M","1Y"]},series:x(),grid:[{left:"10%",right:"8%",height:"65%"},{left:"10%",right:"8%",height:"65%"},{left:"10%",right:"8%",height:"65%"}],xAxis:[{type:"category",data:o.data.category,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0,splitArea:{show:!0},splitLine:{lineStyle:{type:"dashed",color:"#3C3C3C",width:1}},min:n=>n.min>o.data.lastClose?(o.data.lastClose*.99).toFixed(0):(n.min*.99).toFixed(0),max:n=>n.max>o.data.lastClose?(n.max*1.01).toFixed(0):(o.data.lastClose*1.01).toFixed(0)}]}},x=()=>{let n={name:"1Y",type:"line",showSymbol:!1,data:o.data.trend,markLine:{label:{show:!1},symbol:["none","none"],data:[{yAxis:o.data.lastClose,name:"固定值 100"}],lineStyle:{color:"#FFF"}},markPoint:{data:[{type:"max",name:"Max",label:{position:"top",distance:-10}},{type:"min",name:"Min",label:{position:"bottom",distance:-10}}],symbol:"image://",label:{show:!0,formatter:function(s){return s.value>o.data.lastClose?`{a|${s.value}}`:`{b|${s.value}}`},rich:{a:{color:Z},b:{color:N}}}}},t=f.deepClone({},n);t.name="1M";let e=f.deepClone({},n);return e.name="6M",[n,t,e]},g=n=>{o.data.currentSel=n.name,m("chgLegend",n.name)};return(n,t)=>{var e,s;return A(),V("div",null,[w(h(H),{ref_key:"chart",ref:a,class:F({chart:!((e=h(o).data)!=null&&e.isBig),chartBig:(s=h(o).data)==null?void 0:s.isBig}),option:u.value,onLegendselectchanged:g,autoresize:""},null,8,["class","option"])])}}},J=B(q,[["__scopeId","data-v-8ae0dc80"]]),Q={class:"index"},ee={class:"flex ml-10 bolder fz-18"},te={class:"flex justify-around flex-wrap"},ae={__name:"index",setup(M){j(E,"dark");const c=I();b(null);const p=b([1,2]),m=(t,e)=>{t&&(p.value=p.value.map(s=>s+1),p.value[e]=1)},a=k({data:{list:[],volume:[],trend:[],category:[],low:"",high:"",closePrice:"",priceUp:"",percent:"",width:"",isBig:!1,currentSel:"走勢"}}),u=k({data:{trend:[],category:[],lastClose:0,currentSel:"1Y"}}),o=K(()=>({red:a.data.closePrice>c.info.data.previousClose,green:a.data.closePrice<c.info.data.previousClose}));z(()=>c.candles.data,()=>{x(),l()},{deep:!0}),L(async()=>{Object.keys(c.candles.data).length===0||Object.keys(c.info.data).length===0||(x(),l(),g("1Y"))});const l=()=>{a.data.priceUp=(a.data.closePrice-c.info.data.previousClose).toFixed(2),a.data.percent=(a.data.priceUp/c.info.data.previousClose*100).toFixed(2)},x=()=>{a.data.list=c.candles.data.data.map(e=>[e.open,e.close,e.low,e.high]),a.data.trend=c.candles.data.data.map(e=>({value:[f.dateFormate(e.date,"hhmm"),e.close]}));let t;a.data.volume=c.candles.data.data.map((e,s)=>{let r=1;return t&&(e.close>t?r=1:r=-1),t=e.close,[s,e.volume,r]}),a.data.category=c.candles.data.data.map(e=>f.dateFormate(e.date,"hhmm")),a.data.closePrice=a.data.list[a.data.list.length-1][1],a.data.low=a.data.list.reduce((e,s)=>e[1]<s[1]?e:s),a.data.high=a.data.list.reduce((e,s)=>e[1]>s[1]?e:s)},g=async t=>{let e,s=new Date,r=new Date;t=="1Y"?(r.setFullYear(s.getFullYear()-1),r.setDate(r.getDate()+1)):t=="6M"?(r.setMonth(s.getMonth()-6),r.setDate(r.getDate()+1)):t=="1M"&&(r.setMonth(s.getMonth()-1),r.setDate(r.getDate()+1)),e=await D.Stock.getStockHistory("IX0001","D",f.dateFormate(r,"yymmdd"),f.dateFormate(s,"yymmdd")),u.data.trend=e.data.map(d=>({value:[d.date,d.close]})).reverse(),u.data.category=e.data.map(d=>d.date).reverse(),s=new Date,r=new Date,t=="1Y"?s.setFullYear(s.getFullYear()-1):t=="6M"?s.setMonth(s.getMonth()-6):t=="1M"&&s.setMonth(s.getMonth()-1),e=await D.Stock.getStockHistory("IX0001","M",f.dateFormate(s,"yymmdd"),f.dateFormate(s,"yymmdd")),u.data.lastClose=e.data[0].close},n=t=>{g(t)};return(t,e)=>(A(),V("div",Q,[v("div",ee,[v("div",null,$(h(c).info.data.name),1),v("div",{class:F([o.value,"ml-10"])},$(a.data.closePrice),3),v("div",{class:F([o.value,"ml-10"])},$(`${a.data.priceUp>0?"+":"-"}${a.data.priceUp}`),3),v("div",{class:F([o.value,"ml-10"])},$(`${a.data.priceUp>0?"+":"-"}${a.data.percent}%`),3)]),v("div",te,[w(U,{name:"fade"},{default:T(()=>[w(G,{candles:a,style:O({order:p.value[0]}),onReOrder:m,class:"mb-10 orderAnimate"},null,8,["candles","style"]),w(J,{candles:u,style:O({order:p.value[1]}),onReOrder:m,onChgLegend:n,class:"mb-10 orderAnimate"},null,8,["candles","style"])]),_:1})])]))}},ne=B(ae,[["__scopeId","data-v-09c7ce44"]]);export{ne as default};
