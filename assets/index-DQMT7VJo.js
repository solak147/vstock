import{_ as M,H as z,r as C,a as B,w as A,e as V,q as L,z as P,j as w,I as F,u as v,p as E,c as K,J as O,E as b,G as I,t as R,K as G,v as D}from"./index-BK1iOhNn.js";import{E as U,T as Z}from"./index-X0DW2wi4.js";import{U as y}from"./index-g1FXTl7-.js";const S="#FF5B5B",Y="#ff3737",k="#91F840",H="#6fda1a",N={__name:"RealTimeChart",props:{candles:{type:Object,default:{}}},emits:["reOrder"],setup(_,{emit:p}){const f=_,g=p,l=z(),u=C(null),x=C(null);let a=B({});A(()=>f.candles,()=>{a=f.candles,h()},{deep:!0}),V(()=>{a=f.candles,a.data.width=u.value.getWidth()});const h=()=>{x.value={backgroundColor:"#131313",title:{text:"即時走勢",left:10,top:10,bottom:10,textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(0,0,0,0.3)",textStyle:{color:"#FFF"},formatter:function(t){let e=t.filter(m=>m.seriesIndex==0)[0],n=t.filter(m=>m.seriesIndex==1)[0],c=t.filter(m=>m.seriesIndex==2)[0],i,o,r;return e?(i=a.data.list[e.dataIndex-1]?a.data.list[e.dataIndex-1][1]:l.info.data.previousClose,o=(e.value[2]-i).toFixed(2),r=(o/i*100).toFixed(2),`<div style=" text-align: left;">
                        ${t[0].name} <br/>
                        <span style="color:${s(e.value[1],i)}">開 :<span style="margin-left: 20px">${e.value[1]}</span></span><br/>
                        <span style="color:${s(e.value[2],i)}">收 :<span style="margin-left: 20px">${e.value[2]}</span></span><br/>
                        <span style="color:${s(e.value[3],i)}">低 :<span style="margin-left: 20px">${e.value[3]}</span></span><br/>
                        <span style="color:${s(e.value[4],i)}">高 :<span style="margin-left: 20px">${e.value[4]}</span></span><br/> 
                        <span style="color:${s(o)}">${o>0?"漲":"跌"} :<span style="margin-left: 20px">${o>0?"+"+o:o}</span></span><br/>
                        <span style="color:${s(o)}">幅 :<span style="margin-left: 20px">${o>0?"+"+r:r}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(n.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`):(i=l.info.data.previousClose,o=(c.value[1]-i).toFixed(2),r=(o/i*100).toFixed(2),`<div style=" text-align: left;">
                        ${t[0].name} <br/>
                        <span style="color:${s(c.value[1],l.info.data.previousClose)}">價 :<span style="margin-left: 20px">${c.value[1]}</span></span><br/>
                        <span style="color:${s(o)}">${o>0?"漲":"跌"} :<span style="margin-left: 20px">${o>0?"+"+o:o}</span></span><br/>
                        <span style="color:${s(o)}">幅 :<span style="margin-left: 20px">${o>0?"+"+r:r}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(n.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`)},position:function(t,e,n,c,i){const o={top:10};return o[["left","right"][+(t[0]<i.viewSize[0]/2)]]=30,o}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},toolbox:{show:!0,top:10,right:10,feature:{mytooo:{show:!0,title:"Custom Button",icon:"path://m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z",onclick:function(){u.value.resize({width:a.data.isBig?a.data.width:a.data.width*2}),a.data.isBig=!a.data.isBig,g("reOrder",a.data.isBig,0)}}}},dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"85%",start:0,end:100}],visualMap:[{show:!1,seriesIndex:1,dimension:2,pieces:[{value:-1,color:k},{value:1,color:S}]},{show:!1,seriesIndex:2,dimension:1,pieces:[{lte:l.info.data.previousClose-1,color:H},{gt:l.info.data.previousClose,color:Y}]}],legend:{selected:{一分K:!1,走勢:!0},top:10,selectedMode:"single",data:["走勢","一分K"]},series:[{name:"一分K",type:"candlestick",data:a.data.list,itemStyle:{color:S,color0:k,borderColor:Y,borderColor0:H},tooltip:{formatter:function(t){return t.name+"<br>"+(t.data.coord||"")}},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,data:a.data.volume},{name:"走勢",type:"line",showSymbol:!1,data:a.data.trend,markLine:{label:{show:!1},symbol:["none","none"],data:[{yAxis:l.info.data.previousClose,name:"固定值 100"}],lineStyle:{color:"#FFF"}},markPoint:{data:[{type:"max",name:"Max",label:{position:"top",distance:-10}},{type:"min",name:"Min",label:{position:"bottom",distance:-10}}],symbol:"image://",label:{show:!0,formatter:function(t){return t.value>l.info.data.previousClose?`{a|${t.value}}`:`{b|${t.value}}`},rich:{a:{color:S},b:{color:k}}}}}],grid:[{left:"10%",right:"8%",height:"50%"},{left:"10%",right:"8%",top:"63%",height:"16%"}],xAxis:[{type:"category",data:a.data.category,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"},{type:"category",gridIndex:1,data:a.data.category,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0,splitArea:{show:!0},splitLine:{lineStyle:{type:"dashed",color:"#3C3C3C",width:1}},min:t=>a.data.currentSel=="一分K"?t.min:a.data.openPrice>l.info.data.previousClose?(l.info.data.previousClose*.99).toFixed(0):(t.min*.99).toFixed(0),max:t=>a.data.currentSel=="一分K"?t.max:a.data.openPrice>l.info.data.previousClose?(t.max*1.01).toFixed(0):(l.info.data.previousClose*1.01).toFixed(0)},{scale:!0,gridIndex:1,splitNumber:2,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}]}},d=t=>{a.data.currentSel=t.name,u.value.resize()},s=(t,e=0)=>{if(t!=e)return t>e?S:k};return(t,e)=>{var n,c;return L(),P("div",null,[w(v(U),{ref_key:"chart",ref:u,class:F({chart:!((n=v(a).data)!=null&&n.isBig),chartBig:(c=v(a).data)==null?void 0:c.isBig}),option:x.value,onLegendselectchanged:d,autoresize:""},null,8,["class","option"])])}}},W=M(N,[["__scopeId","data-v-c088d45d"]]),T="#FF5B5B",X="#ff3737",j="#91F840",q="#6fda1a",J={__name:"HistoryChart",props:{candles:{type:Object,default:{}}},emits:["reOrder"],setup(_,{emit:p}){const f=_,g=p,l=z(),u=C(null),x=C(null);let a=B({});A(()=>f.candles,()=>{a=f.candles,h()},{deep:!0}),V(()=>{a=f.candles,a.data.width=u.value.getWidth()});const h=()=>{x.value={backgroundColor:"#131313",title:{text:"股價走勢",left:10,top:10,bottom:10,textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(0,0,0,0.3)",textStyle:{color:"#FFF"},formatter:function(e){let n=e.filter($=>$.seriesIndex==0)[0],c=e.filter($=>$.seriesIndex==1)[0],i=e.filter($=>$.seriesIndex==2)[0],o,r,m;return n?(o=a.data.list[n.dataIndex-1]?a.data.list[n.dataIndex-1][1]:l.info.data.previousClose,r=(n.value[2]-o).toFixed(2),m=(r/o*100).toFixed(2),`<div style=" text-align: left;">
                        ${e[0].name} <br/>
                        <span style="color:${t(n.value[1],o)}">開 :<span style="margin-left: 20px">${n.value[1]}</span></span><br/>
                        <span style="color:${t(n.value[2],o)}">收 :<span style="margin-left: 20px">${n.value[2]}</span></span><br/>
                        <span style="color:${t(n.value[3],o)}">低 :<span style="margin-left: 20px">${n.value[3]}</span></span><br/>
                        <span style="color:${t(n.value[4],o)}">高 :<span style="margin-left: 20px">${n.value[4]}</span></span><br/> 
                        <span style="color:${t(r)}">${r>0?"漲":"跌"} :<span style="margin-left: 20px">${r>0?"+"+r:r}</span></span><br/>
                        <span style="color:${t(r)}">幅 :<span style="margin-left: 20px">${r>0?"+"+m:m}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(c.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`):(o=l.info.data.previousClose,r=(i.value[1]-o).toFixed(2),m=(r/o*100).toFixed(2),`<div style=" text-align: left;">
                        ${e[0].name} <br/>
                        <span style="color:${t(i.value[1],l.info.data.previousClose)}">價 :<span style="margin-left: 20px">${i.value[1]}</span></span><br/>
                        <span style="color:${t(r)}">${r>0?"漲":"跌"} :<span style="margin-left: 20px">${r>0?"+"+r:r}</span></span><br/>
                        <span style="color:${t(r)}">幅 :<span style="margin-left: 20px">${r>0?"+"+m:m}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(c.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`)},position:function(e,n,c,i,o){const r={top:10};return r[["left","right"][+(e[0]<o.viewSize[0]/2)]]=30,r}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},toolbox:{show:!0,top:10,right:10,feature:{mytooo:{show:!0,title:"Custom Button",icon:"path://m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z",onclick:function(){u.value.resize({width:a.data.isBig?a.data.width:a.data.width*2}),a.data.isBig=!a.data.isBig,g("reOrder",a.data.isBig,1)}}}},dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"85%",start:0,end:100}],visualMap:[{show:!1,seriesIndex:[0,1],dimension:1,pieces:[{lte:a.data.lastClose-1,color:q},{gt:a.data.lastClose,color:X}]}],legend:{selected:{"1M":!1,"3M":!1,"1Y":!0},top:10,selectedMode:"single",data:["1M","3M","1Y"]},series:d(),grid:[{left:"10%",right:"8%",height:"65%"}],xAxis:[{type:"category",data:a.data.category,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0,splitArea:{show:!0},splitLine:{lineStyle:{type:"dashed",color:"#3C3C3C",width:1}},min:e=>e.min>a.data.lastClose?(a.data.lastClose*.99).toFixed(0):(e.min*.99).toFixed(0),max:e=>e.max>a.data.lastClose?(e.max*1.01).toFixed(0):(a.data.lastClose*1.01).toFixed(0)}]}},d=()=>{let e={name:"1Y",type:"line",showSymbol:!1,data:a.data.trend,markLine:{label:{show:!1},symbol:["none","none"],data:[{yAxis:a.data.lastClose,name:"固定值 100"}],lineStyle:{color:"#FFF"}},markPoint:{data:[{type:"max",name:"Max",label:{position:"top",distance:-10}},{type:"min",name:"Min",label:{position:"bottom",distance:-10}}],symbol:"image://",label:{show:!0,formatter:function(i){return i.value>a.data.lastClose?`{a|${i.value}}`:`{b|${i.value}}`},rich:{a:{color:T},b:{color:j}}}}},n=y.deepClone({},e);n.name="1M";let c=y.deepClone({},e);return c.name="3M",[e,n,c]},s=e=>{a.data.currentSel=e.name,u.value.resize()},t=(e,n=0)=>{if(e!=n)return e>n?T:j};return(e,n)=>{var c,i;return L(),P("div",null,[w(v(U),{ref_key:"chart",ref:u,class:F({chart:!((c=v(a).data)!=null&&c.isBig),chartBig:(i=v(a).data)==null?void 0:i.isBig}),option:x.value,onLegendselectchanged:s,autoresize:""},null,8,["class","option"])])}}},Q=M(J,[["__scopeId","data-v-24c52e7e"]]),ee={class:"index"},ae={class:"flex ml-10 bolder fz-18"},te={class:"flex justify-around flex-wrap"},se={__name:"index",setup(_){E(Z,"dark");const p=z();C(null);const f=C([1,2]),g=(d,s)=>{d&&(f.value=f.value.map(t=>t+1),f.value[s]=1)},l=B({data:{list:[],volume:[],trend:[],category:[],openPrice:"",closePrice:"",priceUp:"",percent:"",width:"",isBig:!1,currentSel:"走勢"}}),u=B({data:{trend:[],category:[],lastClose:0}}),x=K(()=>({red:l.data.closePrice>p.info.data.previousClose,green:l.data.closePrice<p.info.data.previousClose}));A(()=>p.candles.data,()=>{h(),a()},{deep:!0}),V(async()=>{if(Object.keys(p.candles.data).length===0||Object.keys(p.info.data).length===0)return;h(),a();let d=new Date,s=new Date;s.setFullYear(d.getFullYear()-1),s.setDate(s.getDate()+1);let t=await O.Stock.getStockHistory("IX0001","D",y.dateFormate(s,"yymmdd"),y.dateFormate(d,"yymmdd"));u.data.trend=t.data.map(e=>({value:[e.date,e.close]})).reverse(),u.data.category=t.data.map(e=>e.date).reverse(),d=new Date,d.setFullYear(d.getFullYear()-1),s=new Date,s.setFullYear(d.getFullYear()-1),s.setDate(s.getDate()+1),t=await O.Stock.getStockHistory("IX0001","M",y.dateFormate(s,"yymmdd"),y.dateFormate(d,"yymmdd")),u.data.lastClose=Number((t.data.reduce((e,n)=>e+n.close,0)/12).toFixed(2))});const a=()=>{l.data.priceUp=(l.data.closePrice-p.info.data.previousClose).toFixed(2),l.data.percent=(l.data.priceUp/p.info.data.previousClose*100).toFixed(2)},h=()=>{l.data.list=p.candles.data.data.map(s=>[s.open,s.close,s.low,s.high]),l.data.trend=p.candles.data.data.map(s=>({value:[y.dateFormate(s.date,"hhmm"),s.close]}));let d;l.data.volume=p.candles.data.data.map((s,t)=>{let e=1;return d&&(s.close>d?e=1:e=-1),d=s.close,[t,s.volume,e]}),l.data.category=p.candles.data.data.map(s=>y.dateFormate(s.date,"hhmm")),l.data.closePrice=l.data.list[l.data.list.length-1][1],l.data.openPrice=l.data.list[0][0]};return(d,s)=>(L(),P("div",ee,[b("div",ae,[b("div",null,I(v(p).info.data.name),1),b("div",{class:F([x.value,"ml-10"])},I(l.data.closePrice),3),b("div",{class:F([x.value,"ml-10"])},I(`${l.data.priceUp>0?"+":"-"}${l.data.priceUp}`),3),b("div",{class:F([x.value,"ml-10"])},I(`${l.data.priceUp>0?"+":"-"}${l.data.percent}%`),3)]),b("div",te,[w(G,{name:"fade"},{default:R(()=>[w(W,{candles:l,style:D({order:f.value[0]}),onReOrder:g,class:"mb-10 orderAnimate"},null,8,["candles","style"]),w(Q,{candles:u,style:D({order:f.value[1]}),onReOrder:g,class:"mb-10 orderAnimate"},null,8,["candles","style"])]),_:1})])]))}},re=M(se,[["__scopeId","data-v-348dae70"]]);export{re as default};
