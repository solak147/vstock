import{_ as B,H as z,r as C,a as k,w as L,e as A,q as V,z as D,j as w,I as F,u as h,p as U,c as E,J as O,E as b,G as _,t as R,K as G,v as Y}from"./index-DBHBYE1k.js";import{E as K,T as Z}from"./index-veZvi_Kt.js";import{U as x}from"./index-g1FXTl7-.js";const S="#FF5B5B",H="#ff3737",I="#91F840",P="#6fda1a",W={__name:"RealTimeChart",props:{candles:{type:Object,default:{}}},emits:["reOrder"],setup(M,{emit:d}){const c=M,y=d,l=z(),p=C(null),m=C(null);let t=k({});L(()=>c.candles,()=>{t=c.candles,g()},{deep:!0}),A(()=>{t=c.candles,t.data.width=p.value.getWidth()});const g=()=>{m.value={backgroundColor:"#131313",title:{text:"即時走勢",left:10,top:10,bottom:10,textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(0,0,0,0.3)",textStyle:{color:"#FFF"},formatter:function(a){let e=a.filter(f=>f.seriesIndex==0)[0],s=a.filter(f=>f.seriesIndex==1)[0],n=a.filter(f=>f.seriesIndex==2)[0],r,o,i;return e?(r=t.data.list[e.dataIndex-1]?t.data.list[e.dataIndex-1][1]:l.info.data.previousClose,o=(e.value[2]-r).toFixed(2),i=(o/r*100).toFixed(2),`<div style=" text-align: left;">
                        ${a[0].name} <br/>
                        <span style="color:${u(e.value[1],r)}">開 :<span style="margin-left: 20px">${e.value[1]}</span></span><br/>
                        <span style="color:${u(e.value[2],r)}">收 :<span style="margin-left: 20px">${e.value[2]}</span></span><br/>
                        <span style="color:${u(e.value[3],r)}">低 :<span style="margin-left: 20px">${e.value[3]}</span></span><br/>
                        <span style="color:${u(e.value[4],r)}">高 :<span style="margin-left: 20px">${e.value[4]}</span></span><br/> 
                        <span style="color:${u(o)}">${o>0?"漲":"跌"} :<span style="margin-left: 20px">${o>0?"+"+o:o}</span></span><br/>
                        <span style="color:${u(o)}">幅 :<span style="margin-left: 20px">${o>0?"+"+i:i}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(s.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`):(r=l.info.data.previousClose,o=(n.value[1]-r).toFixed(2),i=(o/r*100).toFixed(2),`<div style=" text-align: left;">
                        ${a[0].name} <br/>
                        <span style="color:${u(n.value[1],l.info.data.previousClose)}">價 :<span style="margin-left: 20px">${n.value[1]}</span></span><br/>
                        <span style="color:${u(o)}">${o>0?"漲":"跌"} :<span style="margin-left: 20px">${o>0?"+"+o:o}</span></span><br/>
                        <span style="color:${u(o)}">幅 :<span style="margin-left: 20px">${o>0?"+"+i:i}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(s.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`)},position:function(a,e,s,n,r){const o={top:10};return o[["left","right"][+(a[0]<r.viewSize[0]/2)]]=30,o}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},toolbox:{show:!0,top:10,right:10,feature:{mytooo:{show:!0,title:"Custom Button",icon:"path://m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z",onclick:function(){p.value.resize({width:t.data.isBig?t.data.width:t.data.width*2}),t.data.isBig=!t.data.isBig,y("reOrder",t.data.isBig,0)}}}},dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"85%",start:0,end:100}],visualMap:[{show:!1,seriesIndex:1,dimension:2,pieces:[{value:-1,color:I},{value:1,color:S}]},{show:!1,seriesIndex:2,dimension:1,pieces:[{lte:l.info.data.previousClose-1,color:P},{gt:l.info.data.previousClose,color:H}]}],legend:{selected:{走勢:t.data.currentSel=="走勢",一分K:t.data.currentSel=="一分K"},top:10,selectedMode:"single",data:["走勢","一分K"]},series:[{name:"一分K",type:"candlestick",data:t.data.list,itemStyle:{color:S,color0:I,borderColor:H,borderColor0:P},tooltip:{formatter:function(a){return a.name+"<br>"+(a.data.coord||"")}},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,data:t.data.volume},{name:"走勢",type:"line",showSymbol:!1,data:t.data.trend,markLine:{label:{show:!1},symbol:["none","none"],data:[{yAxis:l.info.data.previousClose,name:"固定值 100"}],lineStyle:{color:"#FFF"}},markPoint:{data:[{type:"max",name:"Max",label:{position:"top",distance:-10}},{type:"min",name:"Min",label:{position:"bottom",distance:-10}}],symbol:"image://",label:{show:!0,formatter:function(a){return a.value>l.info.data.previousClose?`{a|${a.value}}`:`{b|${a.value}}`},rich:{a:{color:S},b:{color:I}}}}}],grid:[{left:"10%",right:"8%",height:"50%"},{left:"10%",right:"8%",top:"63%",height:"16%"}],xAxis:[{type:"category",data:t.data.category,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"},{type:"category",gridIndex:1,data:t.data.category,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0,splitArea:{show:!0},splitLine:{lineStyle:{type:"dashed",color:"#3C3C3C",width:1}},min:a=>t.data.currentSel=="一分K"?a.min:t.data.low>l.info.data.previousClose?(l.info.data.previousClose*.99).toFixed(0):(a.min*.99).toFixed(0),max:a=>t.data.currentSel=="一分K"?a.max:t.data.high>l.info.data.previousClose?(a.max*1.01).toFixed(0):(l.info.data.previousClose*1.01).toFixed(0)},{scale:!0,gridIndex:1,splitNumber:2,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}]}},v=a=>{t.data.currentSel=a.name,p.value.resize()},u=(a,e=0)=>{if(a!=e)return a>e?S:I};return(a,e)=>{var s,n;return V(),D("div",null,[w(h(K),{ref_key:"chart",ref:p,class:F({chart:!((s=h(t).data)!=null&&s.isBig),chartBig:(n=h(t).data)==null?void 0:n.isBig}),option:m.value,onLegendselectchanged:v,autoresize:""},null,8,["class","option"])])}}},N=B(W,[["__scopeId","data-v-23c514a0"]]),T="#FF5B5B",X="#ff3737",j="#91F840",q="#6fda1a",J={__name:"HistoryChart",props:{candles:{type:Object,default:{}}},emits:["reOrder","chgLegend"],setup(M,{emit:d}){const c=M,y=d,l=z(),p=C(null),m=C(null);let t=k({});L(()=>c.candles,()=>{t=c.candles,g()},{deep:!0}),A(()=>{t=c.candles,t.data.width=p.value.getWidth()});const g=()=>{m.value={backgroundColor:"#131313",title:{text:"股價走勢",left:10,top:10,bottom:10,textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(0,0,0,0.3)",textStyle:{color:"#FFF"},formatter:function(e){let s=e.filter($=>$.seriesIndex==0)[0],n=e.filter($=>$.seriesIndex==1)[0],r=e.filter($=>$.seriesIndex==2)[0],o,i,f;return s?(o=t.data.list[s.dataIndex-1]?t.data.list[s.dataIndex-1][1]:l.info.data.previousClose,i=(s.value[2]-o).toFixed(2),f=(i/o*100).toFixed(2),`<div style=" text-align: left;">
                        ${e[0].name} <br/>
                        <span style="color:${a(s.value[1],o)}">開 :<span style="margin-left: 20px">${s.value[1]}</span></span><br/>
                        <span style="color:${a(s.value[2],o)}">收 :<span style="margin-left: 20px">${s.value[2]}</span></span><br/>
                        <span style="color:${a(s.value[3],o)}">低 :<span style="margin-left: 20px">${s.value[3]}</span></span><br/>
                        <span style="color:${a(s.value[4],o)}">高 :<span style="margin-left: 20px">${s.value[4]}</span></span><br/> 
                        <span style="color:${a(i)}">${i>0?"漲":"跌"} :<span style="margin-left: 20px">${i>0?"+"+i:i}</span></span><br/>
                        <span style="color:${a(i)}">幅 :<span style="margin-left: 20px">${i>0?"+"+f:f}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(n.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`):(o=l.info.data.previousClose,i=(r.value[1]-o).toFixed(2),f=(i/o*100).toFixed(2),`<div style=" text-align: left;">
                        ${e[0].name} <br/>
                        <span style="color:${a(r.value[1],l.info.data.previousClose)}">價 :<span style="margin-left: 20px">${r.value[1]}</span></span><br/>
                        <span style="color:${a(i)}">${i>0?"漲":"跌"} :<span style="margin-left: 20px">${i>0?"+"+i:i}</span></span><br/>
                        <span style="color:${a(i)}">幅 :<span style="margin-left: 20px">${i>0?"+"+f:f}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(n.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`)},position:function(e,s,n,r,o){const i={top:10};return i[["left","right"][+(e[0]<o.viewSize[0]/2)]]=30,i}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},toolbox:{show:!0,top:10,right:10,feature:{mytooo:{show:!0,title:"Custom Button",icon:"path://m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z",onclick:function(){p.value.resize({width:t.data.isBig?t.data.width:t.data.width*2}),t.data.isBig=!t.data.isBig,y("reOrder",t.data.isBig,1)}}}},dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"85%",start:0,end:100}],visualMap:[{show:!1,seriesIndex:[0,1,2],dimension:1,pieces:[{lte:t.data.lastClose-1,color:q},{gt:t.data.lastClose,color:X}]}],legend:{selected:{"1M":t.data.currentSel=="1M","6M":t.data.currentSel=="6M","1Y":t.data.currentSel=="1Y"},top:10,selectedMode:"single",data:["1M","6M","1Y"]},series:v(),grid:[{left:"10%",right:"8%",height:"65%"},{left:"10%",right:"8%",height:"65%"},{left:"10%",right:"8%",height:"65%"}],xAxis:[{type:"category",data:t.data.category,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0,splitArea:{show:!0},splitLine:{lineStyle:{type:"dashed",color:"#3C3C3C",width:1}},min:e=>e.min>t.data.lastClose?(t.data.lastClose*.99).toFixed(0):(e.min*.99).toFixed(0),max:e=>e.max>t.data.lastClose?(e.max*1.01).toFixed(0):(t.data.lastClose*1.01).toFixed(0)}]}},v=()=>{let e={name:"1Y",type:"line",showSymbol:!1,data:t.data.trend,markLine:{label:{show:!1},symbol:["none","none"],data:[{yAxis:t.data.lastClose,name:"固定值 100"}],lineStyle:{color:"#FFF"}},markPoint:{data:[{type:"max",name:"Max",label:{position:"top",distance:-10}},{type:"min",name:"Min",label:{position:"bottom",distance:-10}}],symbol:"image://",label:{show:!0,formatter:function(r){return r.value>t.data.lastClose?`{a|${r.value}}`:`{b|${r.value}}`},rich:{a:{color:T},b:{color:j}}}}},s=x.deepClone({},e);s.name="1M";let n=x.deepClone({},e);return n.name="6M",[e,s,n]},u=e=>{t.data.currentSel=e.name,y("chgLegend",e.name)},a=(e,s=0)=>{if(e!=s)return e>s?T:j};return(e,s)=>{var n,r;return V(),D("div",null,[w(h(K),{ref_key:"chart",ref:p,class:F({chart:!((n=h(t).data)!=null&&n.isBig),chartBig:(r=h(t).data)==null?void 0:r.isBig}),option:m.value,onLegendselectchanged:u,autoresize:""},null,8,["class","option"])])}}},Q=B(J,[["__scopeId","data-v-5d39d57b"]]),ee={class:"index"},te={class:"flex ml-10 bolder fz-18"},ae={class:"flex justify-around flex-wrap"},se={__name:"index",setup(M){U(Z,"dark");const d=z();C(null);const c=C([1,2]),y=(a,e)=>{a&&(c.value=c.value.map(s=>s+1),c.value[e]=1)},l=k({data:{list:[],volume:[],trend:[],category:[],low:"",high:"",closePrice:"",priceUp:"",percent:"",width:"",isBig:!1,currentSel:"走勢"}}),p=k({data:{trend:[],category:[],lastClose:0,currentSel:"1Y"}}),m=E(()=>({red:l.data.closePrice>d.info.data.previousClose,green:l.data.closePrice<d.info.data.previousClose}));L(()=>d.candles.data,()=>{g(),t()},{deep:!0}),A(async()=>{Object.keys(d.candles.data).length===0||Object.keys(d.info.data).length===0||(g(),t(),v("1Y"))});const t=()=>{l.data.priceUp=(l.data.closePrice-d.info.data.previousClose).toFixed(2),l.data.percent=(l.data.priceUp/d.info.data.previousClose*100).toFixed(2)},g=()=>{l.data.list=d.candles.data.data.map(e=>[e.open,e.close,e.low,e.high]),l.data.trend=d.candles.data.data.map(e=>({value:[x.dateFormate(e.date,"hhmm"),e.close]}));let a;l.data.volume=d.candles.data.data.map((e,s)=>{let n=1;return a&&(e.close>a?n=1:n=-1),a=e.close,[s,e.volume,n]}),l.data.category=d.candles.data.data.map(e=>x.dateFormate(e.date,"hhmm")),l.data.closePrice=l.data.list[l.data.list.length-1][1],l.data.low=l.data.list.reduce((e,s)=>e[1]<s[1]?e:s),l.data.high=l.data.list.reduce((e,s)=>e[1]>s[1]?e:s)},v=async a=>{let e,s=new Date,n=new Date;a=="1Y"?(n.setFullYear(s.getFullYear()-1),n.setDate(n.getDate()+1)):a=="6M"?(n.setMonth(s.getMonth()-6),n.setDate(n.getDate()+1)):a=="1M"&&(n.setMonth(s.getMonth()-1),n.setDate(n.getDate()+1)),e=await O.Stock.getStockHistory("IX0001","D",x.dateFormate(n,"yymmdd"),x.dateFormate(s,"yymmdd")),p.data.trend=e.data.map(r=>({value:[r.date,r.close]})).reverse(),p.data.category=e.data.map(r=>r.date).reverse(),s=new Date,n=new Date,a=="1Y"?s.setFullYear(s.getFullYear()-1):a=="6M"?s.setMonth(s.getMonth()-6):a=="1M"&&s.setMonth(s.getMonth()-1),e=await O.Stock.getStockHistory("IX0001","M",x.dateFormate(s,"yymmdd"),x.dateFormate(s,"yymmdd")),p.data.lastClose=e.data[0].close},u=a=>{v(a)};return(a,e)=>(V(),D("div",ee,[b("div",te,[b("div",null,_(h(d).info.data.name),1),b("div",{class:F([m.value,"ml-10"])},_(l.data.closePrice),3),b("div",{class:F([m.value,"ml-10"])},_(`${l.data.priceUp>0?"+":"-"}${l.data.priceUp}`),3),b("div",{class:F([m.value,"ml-10"])},_(`${l.data.priceUp>0?"+":"-"}${l.data.percent}%`),3)]),b("div",ae,[w(G,{name:"fade"},{default:R(()=>[w(N,{candles:l,style:Y({order:c.value[0]}),onReOrder:y,class:"mb-10 orderAnimate"},null,8,["candles","style"]),w(Q,{candles:p,style:Y({order:c.value[1]}),onReOrder:y,onChgLegend:u,class:"mb-10 orderAnimate"},null,8,["candles","style"])]),_:1})])]))}},re=B(se,[["__scopeId","data-v-09c7ce44"]]);export{re as default};
