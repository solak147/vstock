import{_ as I,H as k,r as w,a as B,w as M,e as z,q as P,s as L,u as V,p as A,c as E,z as T,E as m,G as h,I as $,j as v,t as C,J as K,x as U,K as j}from"./index-BEyo63bX.js";import{E as O,T as D}from"./index-CMIiKnYI.js";const y="#FF5B5B",S="#ff3737",b="#91F840",F="#6fda1a",H={__name:"RealTimeChart",props:{candles:{type:Object,default:{}}},setup(_){const n=_,e=k(),d=w(null),f=w(null);let l=B({});M(()=>n.candles,()=>{l=n.candles,g()},{deep:!0}),z(()=>{l=n.candles,l.data.width=d.value.getWidth()});const g=()=>{f.value={backgroundColor:"#131313",title:{text:"即時走勢",left:10,top:10,bottom:10,textStyle:{fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(0,0,0,0.3)",textStyle:{color:"#FFF"},formatter:function(a){let t=a.filter(p=>p.seriesIndex==0)[0],x=a.filter(p=>p.seriesIndex==1)[0],u=a.filter(p=>p.seriesIndex==2)[0],r,o,i;return t?(r=l.data.list[t.dataIndex-1]?l.data.list[t.dataIndex-1][1]:e.info.data.previousClose,o=(t.value[2]-r).toFixed(2),i=(o/r*100).toFixed(2),`<div style=" text-align: left;">
                        ${a[0].name} <br/>
                        <span style="color:${s(t.value[1],r)}">開 :<span style="margin-left: 20px">${t.value[1]}</span></span><br/>
                        <span style="color:${s(t.value[2],r)}">收 :<span style="margin-left: 20px">${t.value[2]}</span></span><br/>
                        <span style="color:${s(t.value[3],r)}">低 :<span style="margin-left: 20px">${t.value[3]}</span></span><br/>
                        <span style="color:${s(t.value[4],r)}">高 :<span style="margin-left: 20px">${t.value[4]}</span></span><br/> 
                        <span style="color:${s(o)}">${o>0?"漲":"跌"} :<span style="margin-left: 20px">${o>0?"+"+o:o}</span></span><br/>
                        <span style="color:${s(o)}">幅 :<span style="margin-left: 20px">${o>0?"+"+i:i}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(x.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`):(r=e.info.data.previousClose,o=(u.value[1]-r).toFixed(2),i=(o/r*100).toFixed(2),`<div style=" text-align: left;">
                        ${a[0].name} <br/>
                        <span style="color:${s(u.value[1],e.info.data.previousClose)}">價 :<span style="margin-left: 20px">${u.value[1]}</span></span><br/>
                        <span style="color:${s(o)}">${o>0?"漲":"跌"} :<span style="margin-left: 20px">${o>0?"+"+o:o}</span></span><br/>
                        <span style="color:${s(o)}">幅 :<span style="margin-left: 20px">${o>0?"+"+i:i}%</span></span><br/>
                        量 :<span style="margin-left: 20px">${(x.value[1]/1e8).toFixed(3)}億元</span><br/> 
                    </div>`)},position:function(a,t,x,u,r){const o={top:10};return o[["left","right"][+(a[0]<r.viewSize[0]/2)]]=30,o}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},toolbox:{show:!0,top:10,right:10,feature:{mytooo:{show:!0,title:"Custom Button",icon:"path://m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z",onclick:function(){d.value.resize({width:l.data.isBig?l.data.width:1500}),l.data.isBig=!l.data.isBig}}}},dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"85%",start:0,end:100}],visualMap:[{show:!1,seriesIndex:1,dimension:2,pieces:[{value:-1,color:b},{value:1,color:y}]},{show:!1,seriesIndex:2,dimension:1,pieces:[{lte:e.info.data.previousClose-1,color:F},{gt:e.info.data.previousClose,color:S}]}],legend:{selected:{一分K:!1,走勢:!0},top:10,selectedMode:"single",data:["走勢","一分K"]},series:[{name:"一分K",type:"candlestick",data:l.data.list,itemStyle:{color:y,color0:b,borderColor:S,borderColor0:F},tooltip:{formatter:function(a){return a.name+"<br>"+(a.data.coord||"")}},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,data:l.data.volume},{name:"走勢",type:"line",showSymbol:!1,data:l.data.trend,markLine:{label:{show:!1},symbol:["none","none"],data:[{yAxis:e.info.data.previousClose,name:"固定值 100"}],lineStyle:{color:"#FFF"}},markPoint:{data:[{type:"max",name:"Max",label:{position:"top",distance:-10}},{type:"min",name:"Min",label:{position:"bottom",distance:-10}}],symbol:"image://",label:{show:!0,formatter:function(a){return a.value>e.info.data.previousClose?`{a|${a.value}}`:`{b|${a.value}}`},rich:{a:{color:y},b:{color:b}}}}}],grid:[{left:"10%",right:"8%",height:"50%"},{left:"10%",right:"8%",top:"63%",height:"16%"}],xAxis:[{type:"category",data:l.data.category,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"},{type:"category",gridIndex:1,data:l.data.category,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0,splitArea:{show:!0},splitLine:{lineStyle:{type:"dashed",color:"#3C3C3C",width:1}},min:a=>l.data.currentSel=="一分K"?a.min:l.data.openPrice>e.info.data.previousClose?(e.info.data.previousClose*.99).toFixed(0):(a.min*.99).toFixed(0),max:a=>l.data.currentSel=="一分K"?a.max:l.data.openPrice>e.info.data.previousClose?(a.max*1.01).toFixed(0):(e.info.data.previousClose*1.01).toFixed(0)},{scale:!0,gridIndex:1,splitNumber:2,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}]}},c=a=>{l.data.currentSel=a.name,d.value.resize()},s=(a,t=0)=>{if(a!=t)return a>t?y:b};return(a,t)=>(P(),L(V(O),{ref_key:"chart",ref:d,class:"chart",option:f.value,onLegendselectchanged:c,autoresize:""},null,8,["option"]))}},N=I(H,[["__scopeId","data-v-707535d9"]]),R={class:"index"},G={class:"flex ml-10 bolder fz-18"},Z={__name:"index",setup(_){A(D,"dark");const n=k();w(null);const e=B({data:{list:[],volume:[],trend:[],category:[],openPrice:"",closePrice:"",priceUp:"",percent:"",width:"",isBig:!1,currentSel:"走勢"}}),d=E(()=>({red:e.data.closePrice>n.info.data.previousClose,green:e.data.closePrice<n.info.data.previousClose}));M(()=>n.candles.data,()=>{l(),f()},{deep:!0}),z(async()=>{Object.keys(n.candles.data).length===0||Object.keys(n.info.data).length===0||(l(),f())});const f=()=>{e.data.priceUp=(e.data.closePrice-n.info.data.previousClose).toFixed(2),e.data.percent=(e.data.priceUp/n.info.data.previousClose*100).toFixed(2)},l=()=>{e.data.list=n.candles.data.data.map(s=>[s.open,s.close,s.low,s.high]),e.data.trend=n.candles.data.data.map(s=>({value:[g(s.date),s.close]}));let c;e.data.volume=n.candles.data.data.map((s,a)=>{let t=1;return c&&(s.close>c?t=1:t=-1),c=s.close,[a,s.volume,t]}),e.data.category=n.candles.data.data.map(s=>g(s.date)),e.data.closePrice=e.data.list[e.data.list.length-1][1],e.data.openPrice=e.data.list[0][0]},g=(c,s)=>{let a=c,t=new Date(a),x=t.getFullYear(),u=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0"),p=String(t.getSeconds()).padStart(2,"0");return`${o}:${i}`};return(c,s)=>{const a=j,t=K;return P(),T("div",R,[m("div",G,[m("div",null,h(V(n).info.data.name),1),m("div",{class:$([d.value,"ml-10"])},h(e.data.closePrice),3),m("div",{class:$([d.value,"ml-10"])},h(`${e.data.priceUp>0?"+":"-"}${e.data.priceUp}`),3),m("div",{class:$([d.value,"ml-10"])},h(`${e.data.priceUp>0?"+":"-"}${e.data.percent}%`),3)]),v(t,{gutter:20,class:"row"},{default:C(()=>[v(a,{span:10},{default:C(()=>[v(N,{candles:e},null,8,["candles"])]),_:1}),v(a,{span:12},{default:C(()=>[U(" 11 ")]),_:1})]),_:1})])}}},q=I(Z,[["__scopeId","data-v-e4d25774"]]);export{q as default};
